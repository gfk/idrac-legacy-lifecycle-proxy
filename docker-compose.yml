services:
  idrac-dns:
    image: alpine:latest
    container_name: idrac-dns
    # -d = Debug (Foreground + Log to console)
    # -C = Use this specific config file
    command: sh -c "apk add --no-cache dnsmasq && dnsmasq -d -C /etc/dnsmasq.conf"
    ports:
      - "53:53/udp"
      - "53:53/tcp"
    volumes:
      - ./dnsmasq.conf:/etc/dnsmasq.conf
    restart: unless-stopped
    # Grant permission to manage network stack (safeguard for binding port 53)
    cap_add:
      - NET_ADMIN

  dell-catalog-proxy:
    image: nginx:alpine
    container_name: dell-catalog-proxy
    ports:
      - "80:80"
    volumes:
      - ./nginx.conf:/etc/nginx/conf.d/default.conf:ro
    restart: unless-stopped
